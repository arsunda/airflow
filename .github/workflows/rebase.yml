---
name: System dashboard workflow for Microsoft Azure
on:  # yamllint disable-line rule:truthy
  schedule:
    - cron: '* * * * *'
  workflow_dispatch:  # Allows manual triggering
jobs:
  rebase:
    runs-on: ubuntu-latest
    env:
      GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
    steps:
      - name: Checkout Repository
        uses: actions/checkout@v3
        with:
          token: ${{ secrets.AIRFLOW_FORK_TOKEN }}

      - name: Set Up Git
        run: |
          git config --global user.name "Ambika Garg"
          git config --global user.email "ambikagarg1101@gmail.com"

      - name: Upload Artifacts to Azure Blob storage
        run: |
          mkdir -p airflow-github-artifact
          echo "Hello, World!" > airflow-github-artifact/hello.txt

      - uses: fixpoint/azblob-upload-artifact@v4
        with:
          connection-string: ${{ secrets.AZURE_STORAGE_CONNECTION_STRING }}
          name: my-artifact
          path: airflow-github-artifact


      # - name: Git Pull
      #   run: |
      #     git pull --unshallow

      # - name: Fetch Upstream
      #   run: |
      #     git remote add upstream https://github.com/apache/airflow.git
      #     git fetch upstream

      # - name: Rebase Fork with Upstream
      #   run: |
      #     git checkout main
      #     git rebase upstream/main
      #     git push origin main --force-with-lease

      # - name: "Install Breeze"
      #   uses: ./.github/actions/breeze
      # - name: "Run Breeze tests"
      #   run: |
      #     breeze testing tests tests/system/providers/microsoft/azure/example_mock_test.py --system microsoft --junitxml=tests/system/providers/microsoft/azure/pytest_report/pytest-report.xml

      # - name: Upload pytest report
      #   uses: actions/upload-artifact@v3
      #   with:
      #     name: pytest-report
      #     path: tests/system/providers/microsoft/azure/pytest_report/pytest-report.xml

      # - name: Download pytest report
      #   uses: actions/download-artifact@v3
      #   with:
      #     name: pytest-report
